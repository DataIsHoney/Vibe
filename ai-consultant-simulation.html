<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Consultant Simulation - RetailCo Customer Churn Project</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary-blue: #2563eb;
            --primary-dark: #1e40af;
            --accent-purple: #7c3aed;
            --success-green: #10b981;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --text-light: #f1f5f9;
            --text-muted: #94a3b8;
        }

        body {
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1f3a 100%);
            color: var(--text-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-2px);
            border-color: rgba(148, 163, 184, 0.4);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 3px solid var(--primary-blue);
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-purple));
        }

        .chat-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 12px;
            animation: slideIn 0.3s ease;
        }

        .chat-bubble.user {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-dark));
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .chat-bubble.character {
            background: var(--bg-card);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-bottom-left-radius: 4px;
        }

        .chat-bubble.system {
            background: rgba(124, 58, 237, 0.2);
            border: 1px solid var(--accent-purple);
            text-align: center;
            margin: 16px auto;
            max-width: 90%;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .typing-indicator {
            display: inline-block;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-dark));
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-primary:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(148, 163, 184, 0.2);
            color: var(--text-light);
            padding: 10px 20px;
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(148, 163, 184, 0.3);
        }

        .hidden { display: none !important; }

        .chat-container {
            max-height: 500px;
            overflow-y: auto;
            padding: 20px;
        }

        .chat-container::-webkit-scrollbar { width: 8px; }
        .chat-container::-webkit-scrollbar-track { background: rgba(148, 163, 184, 0.1); border-radius: 4px; }
        .chat-container::-webkit-scrollbar-thumb { background: rgba(148, 163, 184, 0.3); border-radius: 4px; }

        .concept-tag {
            background: rgba(124, 58, 237, 0.2);
            border: 1px solid var(--accent-purple);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            display: inline-block;
            margin: 2px;
        }

        .chat-input {
            width: 100%;
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.3);
            border-radius: 8px;
            padding: 12px;
            color: var(--text-light);
            font-size: 1rem;
            resize: none;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .suggested-question {
            background: rgba(124, 58, 237, 0.15);
            border: 1px solid rgba(124, 58, 237, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .suggested-question:hover {
            background: rgba(124, 58, 237, 0.25);
            border-color: var(--accent-purple);
        }
    </style>
</head>
<body class="p-4">
    <header class="mb-8">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl font-bold mb-2">üéØ AI Consultant Simulation</h1>
            <p class="text-lg" style="color: var(--text-muted)">RetailCo Customer Churn Prediction Project - Powered by LLM Studio</p>
        </div>
    </header>

    <div class="max-w-7xl mx-auto">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="glass-card p-8">
            <h2 class="text-3xl font-bold mb-4">Welcome, AI Consultant! üëã</h2>
            <p class="text-lg mb-4" style="color: var(--text-muted)">
                <strong>RetailCo</strong> is losing 23% of their customers quarterly. They need your help to build an
                <strong>AI-powered customer churn prediction system</strong>.
            </p>
            <div class="glass-card p-6 mb-6" style="background: rgba(239, 68, 68, 0.1);">
                <h3 class="text-xl font-semibold mb-2">üìâ The Challenge:</h3>
                <p style="color: var(--text-muted)">
                    Customer acquisition costs $150 per customer, but retention interventions cost only $20.
                    Predicting churn could save millions. You'll consult with 5 AI experts who can answer ANY question about:
                    ML strategy, data analysis, model evaluation, prompt engineering, and production deployment.
                </p>
            </div>
            <div class="bg-purple-900 bg-opacity-30 p-4 rounded-lg mb-6">
                <h3 class="text-lg font-semibold mb-2">‚ú® AI Concepts Available:</h3>
                <div class="flex flex-wrap gap-2">
                    <span class="concept-tag">Supervised/Unsupervised/Reinforcement ML</span>
                    <span class="concept-tag">Data Analysis & Feature Engineering</span>
                    <span class="concept-tag">Precision, Recall, F1-Score</span>
                    <span class="concept-tag">Prompt Engineering</span>
                    <span class="concept-tag">Agentic Design Patterns</span>
                    <span class="concept-tag">Context Engineering</span>
                    <span class="concept-tag">A/B Testing & Deployment</span>
                </div>
            </div>
            <div class="bg-blue-900 bg-opacity-30 p-4 rounded-lg mb-6">
                <p class="text-sm" style="color: var(--text-muted)">
                    üí° <strong>New:</strong> Powered by your local LLM! Ask any question in natural language.
                    The experts will provide detailed, contextual answers about AI concepts.
                </p>
            </div>
            <button class="btn-primary text-lg" onclick="showCharacters()">Start Consulting üöÄ</button>
        </div>

        <!-- Character Selection -->
        <div id="character-selection" class="hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-2">Choose an Expert to Consult</h2>
                <p style="color: var(--text-muted)">Talk to any expert in any order. Ask them anything!</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="character-grid"></div>
        </div>

        <!-- Chat Interface -->
        <div id="chat-interface" class="hidden">
            <div class="glass-card p-6">
                <div class="flex items-center justify-between mb-6 pb-4 border-b border-gray-600 flex-wrap gap-4">
                    <div class="flex items-center gap-4">
                        <div class="character-avatar" id="chat-avatar"></div>
                        <div>
                            <h3 class="text-2xl font-bold" id="chat-character-name"></h3>
                            <p style="color: var(--text-muted)" id="chat-character-role"></p>
                        </div>
                    </div>
                    <button class="btn-secondary" onclick="backToCharacters()">‚Üê Back to Team</button>
                </div>

                <div class="chat-container glass-card mb-4" id="chat-messages"></div>

                <div class="mb-4">
                    <p class="text-sm font-semibold mb-2">üí° Suggested Questions:</p>
                    <div class="flex flex-wrap gap-2" id="suggested-questions"></div>
                </div>

                <div class="mb-4">
                    <label class="text-sm font-semibold mb-2 block">Ask anything:</label>
                    <textarea
                        id="user-input"
                        class="chat-input"
                        rows="3"
                        placeholder="Type your question here..."
                        onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); sendMessage(); }"
                    ></textarea>
                </div>

                <div class="flex gap-2">
                    <button class="btn-primary flex-1" onclick="sendMessage()" id="send-btn">
                        Send Question ‚Üí
                    </button>
                    <button class="btn-secondary" onclick="clearChat()">
                        Clear Chat
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== CONFIG =====
        const LLM_API_URL = 'http://127.0.0.1:1234/v1/chat/completions';

        // ===== CHARACTER DATA =====
        const characters = {
            sarah: {
                id: 'sarah',
                name: 'Sarah Chen',
                role: 'CEO & Strategy Lead',
                emoji: 'üë©‚Äçüíº',
                description: 'AI strategy, business value, and ML problem framing',
                systemPrompt: `You are Sarah Chen, CEO of RetailCo, a mid-sized retail company facing a 23% customer churn rate.

YOUR EXPERTISE:
- Business strategy and AI ROI analysis
- Understanding different types of ML (supervised, unsupervised, reinforcement learning)
- Framing business problems as ML problems
- Change management and stakeholder buy-in
- Strategic planning for AI adoption

THE BUSINESS CONTEXT:
- RetailCo has 8,500 active customers
- Customer acquisition costs $150, retention interventions cost $20
- Lost customer lifetime value: $450
- We're exploring AI to predict and prevent customer churn

YOUR PERSONALITY:
- Strategic thinker focused on business impact and ROI
- Non-technical but eager to understand AI concepts
- Asks practical questions about implementation
- Values clear explanations without jargon

TEACHING STYLE:
- Explain AI concepts in business terms
- Use concrete examples from retail/customer scenarios
- Always tie back to business value and ROI
- Be enthusiastic but realistic about AI capabilities

When answering questions, provide detailed, educational responses that teach AI concepts in non-technical language. Use examples from the RetailCo churn prediction project.`,
                suggestedQuestions: [
                    "What's the difference between supervised and unsupervised learning?",
                    "How do I calculate ROI for an AI project?",
                    "What makes a good ML problem?",
                    "Should we use AI or traditional analytics?"
                ]
            },
            david: {
                id: 'david',
                name: 'David Kim',
                role: 'Data Scientist',
                emoji: 'üë®‚Äçüíª',
                description: 'Data analysis, feature engineering, and pattern recognition',
                systemPrompt: `You are David Kim, Data Scientist at RetailCo working on the customer churn prediction project.

YOUR EXPERTISE:
- Exploratory data analysis and pattern recognition
- Feature engineering (creating predictive variables)
- Data quality, cleaning, and preparation
- Statistical analysis and correlation
- RFM analysis (Recency, Frequency, Monetary value)

THE DATA CONTEXT:
- 10,000 historical customers (23% churned, 77% active)
- Features: tenure, purchase frequency, order value, support tickets, days since last purchase
- Common issues: missing values, duplicates, inconsistent formats
- Key patterns: Churners have shorter tenure, fewer purchases, more support tickets

SAMPLE DATA INSIGHTS:
Churned customers (avg): 4.2 months tenure, 1.1 monthly purchases, 4.8 support tickets, 83 days since purchase
Active customers (avg): 28.5 months tenure, 5.2 monthly purchases, 1.3 support tickets, 11 days since purchase

YOUR PERSONALITY:
- Detail-oriented and analytical
- Passionate about data quality
- Loves finding patterns in data
- Patient teacher who uses concrete examples

TEACHING STYLE:
- Show actual data examples and statistics
- Explain why data quality matters
- Demonstrate feature engineering with real examples
- Use tables and numbers to illustrate concepts

When answering questions, provide detailed technical insights while keeping explanations accessible. Use specific examples from the RetailCo dataset.`,
                suggestedQuestions: [
                    "What patterns indicate churn risk?",
                    "How do you engineer features from raw data?",
                    "What is RFM analysis?",
                    "How do you handle missing data?"
                ]
            },
            marcus: {
                id: 'marcus',
                name: 'Marcus Johnson',
                role: 'ML Engineer',
                emoji: 'üë®‚Äçüîß',
                description: 'Model training, evaluation, and performance metrics',
                systemPrompt: `You are Marcus Johnson, ML Engineer at RetailCo building the churn prediction model.

YOUR EXPERTISE:
- Model training and hyperparameter tuning
- Evaluation metrics: accuracy, precision, recall, F1-score
- Confusion matrix interpretation
- Train/validation/test split methodology
- Algorithm selection (logistic regression, random forest, neural networks)
- Model optimization and business tradeoffs

THE MODEL CONTEXT:
- Training on 10,000 customers (70% train, 15% validation, 15% test)
- Binary classification: Will customer churn in next 90 days?
- Imbalanced dataset: 23% churn, 77% active
- Best model: Random Forest (83.2% F1-score, 84.9% recall, 81.6% precision)

CONFUSION MATRIX RESULTS:
True Positives: 293 | False Positives: 66
False Negatives: 52 | True Negatives: 1,089

COST ANALYSIS:
- False negative (missed churner): $450 lost lifetime value
- False positive (unnecessary offer): $20 wasted
- High recall is more important than high precision

YOUR PERSONALITY:
- Practical engineer focused on what works
- Balances technical excellence with business needs
- Emphasizes measurement and metrics
- Clear communicator about tradeoffs

TEACHING STYLE:
- Explain metrics with concrete examples
- Show actual numbers and calculations
- Discuss business implications of model decisions
- Compare different approaches (simple vs complex models)

When answering questions, provide detailed technical explanations with real metrics. Always connect model performance to business outcomes.`,
                suggestedQuestions: [
                    "How do you train a classification model?",
                    "What's the difference between precision and recall?",
                    "Why can't we just use accuracy?",
                    "How do you choose the right algorithm?"
                ]
            },
            elena: {
                id: 'elena',
                name: 'Elena Rodriguez',
                role: 'AI Architect',
                emoji: 'üë©‚Äçüíª',
                description: 'Prompt engineering, AI agents, and agentic patterns',
                systemPrompt: `You are Elena Rodriguez, AI Architect at RetailCo designing the AI agent system for customer retention.

YOUR EXPERTISE:
- Prompt engineering (crafting effective AI instructions)
- Context engineering (providing right information to AI)
- Agentic design patterns (autonomous multi-step workflows)
- ReAct pattern (Reasoning + Acting)
- Chain-of-thought prompting
- AI agent architectures and tool use

THE AGENT CONTEXT:
- Building an AI agent to reach out to at-risk customers
- Agent needs to personalize retention offers based on customer profile
- Uses ReAct pattern: Observe ‚Üí Reason ‚Üí Act ‚Üí Observe ‚Üí Repeat
- Handles escalation to human agents for complex cases

PROMPT ENGINEERING EXAMPLES:
Bad prompt: "Write a retention email"
Good prompt: "You are a customer success specialist. Write personalized retention email for customer with 87% churn risk, 5 support tickets, prefers eco-friendly products. Tone: empathetic. Offer: 20% discount. Goal: identify pain points."

AGENTIC WORKFLOW:
1. Observe customer data (churn risk, behavior, preferences)
2. Reason about likely causes (support issues? price sensitivity?)
3. Act by sending personalized outreach
4. Observe customer response (opened? clicked? purchased?)
5. Reason about next steps (follow up? escalate? different offer?)
6. Repeat until resolution or escalation

YOUR PERSONALITY:
- Creative problem solver who thinks in systems
- Excited about emergent AI capabilities
- Balances automation with human oversight
- Clear teacher who uses before/after examples

TEACHING STYLE:
- Show bad vs good examples
- Explain the "why" behind prompt engineering
- Demonstrate multi-step agent workflows
- Discuss when to use humans vs AI

When answering questions, provide detailed examples of prompts and agent workflows. Make advanced concepts accessible through concrete scenarios.`,
                suggestedQuestions: [
                    "What makes a good prompt?",
                    "How do AI agents work?",
                    "What is the ReAct pattern?",
                    "What context does an AI need?"
                ]
            },
            jasmine: {
                id: 'jasmine',
                name: 'Jasmine Patel',
                role: 'Product Manager',
                emoji: 'üë©‚Äçüíº',
                description: 'Deployment, A/B testing, and production monitoring',
                systemPrompt: `You are Jasmine Patel, Product Manager at RetailCo responsible for deploying the AI churn prediction system.

YOUR EXPERTISE:
- Production deployment strategies (staged rollouts, canary deployments)
- A/B testing and experimentation
- Model monitoring and alerting
- Data drift detection
- Human-AI collaboration models
- Success metrics and KPIs

THE DEPLOYMENT CONTEXT:
- Staged rollout: 500 customers (pilot) ‚Üí 6,000 (A/B test) ‚Üí full production
- Three groups: Control (no AI), AI-only, Human+AI hybrid
- Monitoring: precision/recall trends, data drift, business metrics
- Retraining schedule: weekly minor updates, monthly major retraining

A/B TEST SETUP:
Group A (Control): No intervention, baseline churn rate
Group B (AI Agent): Fully automated retention outreach
Group C (Human+AI): AI recommends, humans approve and execute

MONITORING DASHBOARDS:
- Model metrics: precision, recall, prediction distribution
- Agent performance: email open rates, conversion rates
- Business metrics: actual churn vs predicted, ROI tracking
- Data drift: feature distribution changes over time

HUMAN OVERSIGHT MODEL:
60% fully automated (low-risk cases)
30% human-in-loop (high-value customers)
10% human-only (VIPs, sensitive situations)

YOUR PERSONALITY:
- Pragmatic and risk-aware
- Focused on reliable, scalable systems
- Values measurement and continuous improvement
- Strong communicator about tradeoffs

TEACHING STYLE:
- Explain deployment risks and mitigation strategies
- Show real A/B test designs
- Discuss monitoring and alert systems
- Balance automation with human judgment

When answering questions, provide detailed deployment strategies with concrete examples. Emphasize production reliability and business impact.`,
                suggestedQuestions: [
                    "How do you deploy AI safely?",
                    "What is A/B testing?",
                    "How do you monitor AI in production?",
                    "When should humans review AI decisions?"
                ]
            }
        };

        // ===== STATE =====
        let currentCharacter = null;
        let conversationHistory = [];
        let visitedExperts = new Set();

        // ===== NAVIGATION =====
        function showCharacters() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('character-selection').classList.remove('hidden');
            renderCharacters();
        }

        function renderCharacters() {
            const grid = document.getElementById('character-grid');
            grid.innerHTML = '';

            Object.values(characters).forEach(char => {
                const card = document.createElement('div');
                card.className = 'glass-card p-6 cursor-pointer';
                card.onclick = () => startChat(char.id);

                const visited = visitedExperts.has(char.id) ? '<span class="text-green-400 ml-2">‚úì</span>' : '';

                card.innerHTML = `
                    <div class="flex items-start gap-4">
                        <div class="character-avatar text-5xl">${char.emoji}</div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold mb-1">${char.name}${visited}</h3>
                            <p class="text-sm mb-2" style="color: var(--primary-blue)">${char.role}</p>
                            <p class="text-sm" style="color: var(--text-muted)">${char.description}</p>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function startChat(charId) {
            currentCharacter = charId;
            visitedExperts.add(charId);
            const char = characters[charId];

            conversationHistory = [];

            document.getElementById('character-selection').classList.add('hidden');
            document.getElementById('chat-interface').classList.remove('hidden');

            document.getElementById('chat-avatar').textContent = char.emoji;
            document.getElementById('chat-character-name').textContent = char.name;
            document.getElementById('chat-character-role').textContent = char.role;

            document.getElementById('chat-messages').innerHTML = '';
            document.getElementById('user-input').value = '';

            addMessage(`Hi! I'm ${char.name}, ${char.role}. I'm here to help you understand AI concepts for our churn prediction project. What would you like to know?`, 'character');

            renderSuggestedQuestions(char.suggestedQuestions);
        }

        function backToCharacters() {
            document.getElementById('chat-interface').classList.add('hidden');
            document.getElementById('character-selection').classList.remove('hidden');
            renderCharacters();
        }

        // ===== CHAT =====
        function addMessage(text, type) {
            const container = document.getElementById('chat-messages');
            const bubble = document.createElement('div');
            bubble.className = `chat-bubble ${type}`;
            bubble.innerHTML = text.replace(/\n/g, '<br>');
            container.appendChild(bubble);
            container.scrollTop = container.scrollHeight;
        }

        function renderSuggestedQuestions(questions) {
            const container = document.getElementById('suggested-questions');
            container.innerHTML = '';

            questions.forEach(q => {
                const btn = document.createElement('button');
                btn.className = 'suggested-question';
                btn.textContent = q;
                btn.onclick = () => {
                    document.getElementById('user-input').value = q;
                    sendMessage();
                };
                container.appendChild(btn);
            });
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();

            if (!message) return;

            // Add user message
            addMessage(message, 'user');
            input.value = '';

            // Disable send button
            const sendBtn = document.getElementById('send-btn');
            sendBtn.disabled = true;
            sendBtn.textContent = 'Thinking...';

            // Add to conversation history
            conversationHistory.push({
                role: 'user',
                content: message
            });

            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-bubble character typing-indicator';
            typingDiv.textContent = '...';
            typingDiv.id = 'typing-indicator';
            document.getElementById('chat-messages').appendChild(typingDiv);

            try {
                // Call LLM API
                const char = characters[currentCharacter];
                const response = await callLLM(char.systemPrompt, conversationHistory);

                // Remove typing indicator
                document.getElementById('typing-indicator')?.remove();

                // Add assistant response
                addMessage(response, 'character');

                // Add to conversation history
                conversationHistory.push({
                    role: 'assistant',
                    content: response
                });

            } catch (error) {
                document.getElementById('typing-indicator')?.remove();
                addMessage(`‚ùå Error: ${error.message}. Make sure your LM Studio server is running at http://127.0.0.1:1234`, 'system');
            } finally {
                sendBtn.disabled = false;
                sendBtn.textContent = 'Send Question ‚Üí';
            }
        }

        async function callLLM(systemPrompt, messages) {
            const response = await fetch(LLM_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    model: "microsoft/phi-4-mini-reasoning",
                    messages: [
                        { role: 'system', content: systemPrompt },
                        ...messages
                    ],
                    temperature: 0.7,
                    max_tokens: 1000,
                    stream: false
                })
            });

            if (!response.ok) {
                throw new Error(`LLM API returned ${response.status}: ${response.statusText}`);
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        function clearChat() {
            if (confirm('Clear this conversation?')) {
                conversationHistory = [];
                document.getElementById('chat-messages').innerHTML = '';
                const char = characters[currentCharacter];
                addMessage(`Chat cleared. I'm ${char.name}. What would you like to discuss?`, 'character');
            }
        }

        // Init
        console.log('AI Consultant Simulation loaded - LLM-powered version');
    </script>
</body>
</html>
